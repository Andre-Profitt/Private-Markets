generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma-client"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Report {
  id          String       @id @default(uuid())
  name        String
  reportType  ReportType   @map("report_type")
  
  parameters  Json
  schedule    String?
  
  createdBy   String       @map("created_by")
  createdAt   DateTime     @default(now()) @map("created_at")
  
  executions  ReportExecution[]
  
  @@map("reports")
}

enum ReportType {
  PORTFOLIO_PERFORMANCE
  TRANSACTION_SUMMARY
  KYC_COMPLIANCE
  DEAL_PIPELINE
  REVENUE
  USER_ACTIVITY
  MARKET_OVERVIEW
}

model ReportExecution {
  id          String          @id @default(uuid())
  reportId    String          @map("report_id")
  
  status      ExecutionStatus @default(PENDING)
  result      Json?
  error       String?
  
  executedAt  DateTime        @default(now()) @map("executed_at")
  completedAt DateTime?       @map("completed_at")
  
  report      Report          @relation(fields: [reportId], references: [id])
  
  @@map("report_executions")
}

enum ExecutionStatus {
  PENDING
  RUNNING
  COMPLETED
  FAILED
}

model Metric {
  id          String   @id @default(uuid())
  name        String
  category    String
  
  value       Decimal  @db.Decimal(18, 4)
  unit        String?
  
  dimensions  Json?
  timestamp   DateTime @default(now())
  
  @@map("metrics")
  @@index([name])
  @@index([category])
  @@index([timestamp])
}
