generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma-client"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Document {
  id            String        @id @default(uuid())
  userId        String        @map("user_id")
  entityType    String        @map("entity_type")
  entityId      String?       @map("entity_id")
  
  name          String
  filename      String
  fileType      String        @map("file_type")
  fileSize      Int           @map("file_size")
  s3Key         String        @map("s3_key")
  s3Bucket      String        @map("s3_bucket")
  
  documentType  DocumentType  @map("document_type")
  status        DocumentStatus @default(PENDING)
  
  uploadedAt    DateTime      @default(now()) @map("uploaded_at")
  verifiedAt    DateTime?     @map("verified_at")
  expiresAt     DateTime?     @map("expires_at")
  
  metadata      Json?
  
  @@map("documents")
  @@index([userId])
  @@index([entityType, entityId])
}

enum DocumentType {
  IDENTITY
  ADDRESS_PROOF
  INCOME_VERIFICATION
  ACCREDITATION
  LEGAL_AGREEMENT
  OFFERING_MEMORANDUM
  SUBSCRIPTION_AGREEMENT
  OTHER
}

enum DocumentStatus {
  PENDING
  VERIFIED
  REJECTED
  EXPIRED
}
